# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE)
coxResults[2,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE), 10)
coxResults[3,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE)
coxResults[3,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# display summary
coxResults
adjust_memberships <- readRDS("results/clusterResCond_i100_s1-1.rds")
BNMM_var_co_memberships <- readRDS("results/clusterResPlain_i100_s1-1.rds")
mutCovData <- read.table("data/binary-mutationCovariate-matrix.txt")
## Summarize and relabel cluster assignments ##
cluster.membership <- data.frame("id"=rownames(mutCovData),"groupM"=BNMM_var_memberships$clustermembership
,"groupC"=adjust_memberships$clustermembership, "groupP"=BNMM_var_co_memberships$clustermembership)
# Change group from 1:22 to A:V
cluster.membership$groupM <- as.factor(cluster.membership$groupM)
levels(cluster.membership$groupM) <- LETTERS[1:length(unique(cluster.membership$groupM))]
# Change group from 1:22 to A:V
cluster.membership$groupC <- as.factor(cluster.membership$groupC)
levels(cluster.membership$groupC) <- LETTERS[1:length(unique(cluster.membership$groupC))]
# Change group from 1:22 to A:V
cluster.membership$groupP <- as.factor(cluster.membership$groupP)
levels(cluster.membership$groupP) <- LETTERS[1:length(unique(cluster.membership$groupP))]
# Merge clinical data with clustering
clinical <- merge(output,cluster.membership, by="id", sort=FALSE)
colnames(clinical)[colnames(clinical)=="type"] <- "tissue"
# check how many samples are in each cluster/group
table(clinical$groupM)
table(clinical$groupC)
table(clinical$groupP)
# define continuous and discrete variables
clinical[,c('age','event','time')] <- lapply(clinical[,c('age','event','time')], as.numeric)
# Remove subtype from tissue
clinical[,c('stage','groupM','groupC','groupP','tissue','gender')] <- lapply(clinical[,c('stage','groupM','groupC','groupP','tissue','gender')], factor)
# define empty variable to store results
coxResults <- matrix(NA,3,4)
rownames(coxResults) <- c("Mut","Cond","Plain")
colnames(coxResults) <- c("LR-corrected","pvalue-corrected","LR","pvalue")
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE), 10)
coxResults[1,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
clusterTest <- summary(coxph(Surv(time, event) ~ groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE)
coxResults[1,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE), 10)
coxResults[2,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
clusterTest <- summary(coxph(Surv(time, event) ~ groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE)
coxResults[2,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE), 10)
coxResults[3,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
clusterTest <- summary(coxph(Surv(time, event) ~ groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE)
coxResults[3,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# display summary
coxResults
BNMM_var_memberships <- readRDS("results/BNMM_var_memberships.rds")
adjust_memberships <- readRDS("results/adjust_memberships.rds")
BNMM_var_co_memberships <- readRDS("results/BNMM_var-co_memberships.rds")
mutCovData <- read.table("data/binary-mutationCovariate-matrix.txt")
## Summarize and relabel cluster assignments ##
cluster.membership <- data.frame("id"=rownames(mutCovData),"groupM"=BNMM_var_memberships$clustermembership
,"groupC"=adjust_memberships$clustermembership, "groupP"=BNMM_var_co_memberships$clustermembership)
# Change group from 1:22 to A:V
cluster.membership$groupM <- as.factor(cluster.membership$groupM)
levels(cluster.membership$groupM) <- LETTERS[1:length(unique(cluster.membership$groupM))]
# Change group from 1:22 to A:V
cluster.membership$groupC <- as.factor(cluster.membership$groupC)
levels(cluster.membership$groupC) <- LETTERS[1:length(unique(cluster.membership$groupC))]
# Change group from 1:22 to A:V
cluster.membership$groupP <- as.factor(cluster.membership$groupP)
levels(cluster.membership$groupP) <- LETTERS[1:length(unique(cluster.membership$groupP))]
# Merge clinical data with clustering
clinical <- merge(output,cluster.membership, by="id", sort=FALSE)
colnames(clinical)[colnames(clinical)=="type"] <- "tissue"
# check how many samples are in each cluster/group
table(clinical$groupM)
table(clinical$groupC)
table(clinical$groupP)
# define continuous and discrete variables
clinical[,c('age','event','time')] <- lapply(clinical[,c('age','event','time')], as.numeric)
# Remove subtype from tissue
clinical[,c('stage','groupM','groupC','groupP','tissue','gender')] <- lapply(clinical[,c('stage','groupM','groupC','groupP','tissue','gender')], factor)
# define empty variable to store results
coxResults <- matrix(NA,3,4)
rownames(coxResults) <- c("Mut","Cond","Plain")
colnames(coxResults) <- c("LR-corrected","pvalue-corrected","LR","pvalue")
## cox analysis for all three versions ##
## mutation only version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE), 10)
coxResults[1,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE)
coxResults[1,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## conditional covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE), 10)
coxResults[2,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE)
coxResults[2,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE), 10)
coxResults[3,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE)
coxResults[3,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# display summary
coxResults
BNMM_var_memberships <- readRDS("results/clusterResMut_i100_s1-1.rds")
adjust_memberships <- readRDS("results/clusterResCond_i100_s1-1.rds")
BNMM_var_co_memberships <- readRDS("results/clusterResPlain_i100_s1-1.rds")
mutCovData <- read.table("data/binary-mutationCovariate-matrix.txt")
## Summarize and relabel cluster assignments ##
cluster.membership <- data.frame("id"=rownames(mutCovData),"groupM"=BNMM_var_memberships$clustermembership
,"groupC"=adjust_memberships$clustermembership, "groupP"=BNMM_var_co_memberships$clustermembership)
# Change group from 1:22 to A:V
cluster.membership$groupM <- as.factor(cluster.membership$groupM)
levels(cluster.membership$groupM) <- LETTERS[1:length(unique(cluster.membership$groupM))]
# Change group from 1:22 to A:V
cluster.membership$groupC <- as.factor(cluster.membership$groupC)
levels(cluster.membership$groupC) <- LETTERS[1:length(unique(cluster.membership$groupC))]
# Change group from 1:22 to A:V
cluster.membership$groupP <- as.factor(cluster.membership$groupP)
levels(cluster.membership$groupP) <- LETTERS[1:length(unique(cluster.membership$groupP))]
# Merge clinical data with clustering
clinical <- merge(output,cluster.membership, by="id", sort=FALSE)
colnames(clinical)[colnames(clinical)=="type"] <- "tissue"
# check how many samples are in each cluster/group
table(clinical$groupM)
table(clinical$groupC)
table(clinical$groupP)
# define continuous and discrete variables
clinical[,c('age','event','time')] <- lapply(clinical[,c('age','event','time')], as.numeric)
# Remove subtype from tissue
clinical[,c('stage','groupM','groupC','groupP','tissue','gender')] <- lapply(clinical[,c('stage','groupM','groupC','groupP','tissue','gender')], factor)
# define empty variable to store results
coxResults <- matrix(NA,3,4)
rownames(coxResults) <- c("Mut","Cond","Plain")
colnames(coxResults) <- c("LR-corrected","pvalue-corrected","LR","pvalue")
## cox analysis for all three versions ##
## mutation only version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE), 10)
coxResults[1,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE)
coxResults[1,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## conditional covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE), 10)
coxResults[2,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE)
coxResults[2,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE), 10)
coxResults[3,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE)
coxResults[3,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# display summary
coxResults
## load data ##
output <- read.table("data/tcga-clinical-information.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
BNMM_var_memberships <- readRDS("results/BNMM_var_memberships.rds")
adjust_memberships <- readRDS("results/adjust_memberships.rds")
BNMM_var_co_memberships <- readRDS("results/BNMM_var-co_memberships.rds")
mutCovData <- read.table("data/binary-mutationCovariate-matrix.txt")
## Summarize and relabel cluster assignments ##
cluster.membership <- data.frame("id"=rownames(mutCovData),"groupM"=BNMM_var_memberships$clustermembership
,"groupC"=adjust_memberships$clustermembership, "groupP"=BNMM_var_co_memberships$clustermembership)
# Change group from 1:22 to A:V
cluster.membership$groupM <- as.factor(cluster.membership$groupM)
levels(cluster.membership$groupM) <- LETTERS[1:length(unique(cluster.membership$groupM))]
# Change group from 1:22 to A:V
cluster.membership$groupC <- as.factor(cluster.membership$groupC)
levels(cluster.membership$groupC) <- LETTERS[1:length(unique(cluster.membership$groupC))]
# Change group from 1:22 to A:V
cluster.membership$groupP <- as.factor(cluster.membership$groupP)
levels(cluster.membership$groupP) <- LETTERS[1:length(unique(cluster.membership$groupP))]
# Merge clinical data with clustering
clinical <- merge(output,cluster.membership, by="id", sort=FALSE)
colnames(clinical)[colnames(clinical)=="type"] <- "tissue"
# check how many samples are in each cluster/group
table(clinical$groupM)
table(clinical$groupC)
table(clinical$groupP)
# define continuous and discrete variables
clinical[,c('age','event','time')] <- lapply(clinical[,c('age','event','time')], as.numeric)
# Remove subtype from tissue
clinical[,c('stage','groupM','groupC','groupP','tissue','gender')] <- lapply(clinical[,c('stage','groupM','groupC','groupP','tissue','gender')], factor)
# define empty variable to store results
coxResults <- matrix(NA,3,4)
rownames(coxResults) <- c("Mut","Cond","Plain")
colnames(coxResults) <- c("LR-corrected","pvalue-corrected","LR","pvalue")
## cox analysis for all three versions ##
## mutation only version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE), 10)
coxResults[1,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupM, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupM)) - 1, lower.tail = FALSE)
coxResults[1,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## conditional covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE), 10)
coxResults[2,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupC, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupC)) - 1, lower.tail = FALSE)
coxResults[2,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
## covariates version ##
# Change in likelihood ratio test when variables are added
# Clinical only
stageTest <- summary(coxph(Surv(time, event) ~ stage, data = clinical, na.action = "na.omit"))$logtest[1]
ageTest <- summary(coxph(Surv(time, event) ~ stage + age, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue
tissueTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender, data = clinical, na.action = "na.omit"))$logtest[1]
# Clinical + tissue + group
groupTest <- summary(coxph(Surv(time, as.numeric(event)) ~ stage + age + tissue + gender + groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- round((groupTest-tissueTest)/2, 1)
pvalue <- round(pchisq(q = groupTest-tissueTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE), 10)
coxResults[3,1:2] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# Without correction for confounding factors
clusterTest <- summary(coxph(Surv(time, event) ~ groupP, data = clinical, na.action = "na.omit"))$logtest[1]
LR <- clusterTest/2
pvalue <- pchisq(q = clusterTest, df = length(levels(clinical$groupP)) - 1, lower.tail = FALSE)
coxResults[3,3:4] <- c(LR,pvalue)
paste(round(LR, 1), "&", pvalue, sep = " ")
# display summary
coxResults
times <- c(2.492080839475, 4.43361582756043, 3.95732288360596, 3.75822782516479,
)
times <- c(2.492080839475, 4.43361582756043, 3.95732288360596, 3.75822782516479,
3.76838732163111, 2.693201760451, 6.02806977828344, 3.37815676132838,
4.68702559073766, 2.47450159390767, 3.4806734085083, 3.51701304515203,
6.63697836001714, 3.00759351650874, 3.11664149363836, 4.09351202249527,
5.2349805355072, 4.19295262098312, 5.67635620435079, 6.14057213465373)
times
min(times)
max(times)
mean(times)
std(times)
var(times)
sd(times)
install.packages(“extrafont”)
install.packages('extrafont')
font_import()
library('extrafont')
font_import()
y
font_import()
font_import()
pdf("font_plot.pdf", family="Impact", width = 18, height = 7, units = 'cm', res = 300)
pdf("font_plot.pdf", family="Impact", width = 18, height = 7)
loadfonts()
pdf("font_plot.pdf", family="Impact", width = 18, height = 7)
fonttable()
fonts()
font_import()
font_install()
font_install("Times New Roman")
font_install("Times New Roman")
font_import("Times New Roman")
font_install("Times New Roman")
pdf("font_plot.pdf", family="Times New Roman", width = 18, height = 7)
font_install()
font_install('fontcm')
font_install('fontcm')
par(family="Times")
pdf("font_plot.pdf", family="Times New Roman", width = 18, height = 7)
pdf("font_plot.pdf", family="Times", width = 18, height = 7)
plot_nbg
# Prepare session, load packages
rm(list=ls())
library(ggpubr)
library(ggplot2)
library(RColorBrewer)
library(netClust)
library(reshape2)
# library(extrafont)
###########################
## All Methods displayed ##
###########################
## plot netClust versions for different numbers of covariates
res1 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-0--n_it-30--different--TRUE.rds")
setwd("/Users/frbayer/Desktop/submission/simulations")
# Prepare session, load packages
rm(list=ls())
library(ggpubr)
library(ggplot2)
library(RColorBrewer)
library(netClust)
library(reshape2)
## plot netClust versions for different numbers of covariates
res1 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-0--n_it-30--different--TRUE.rds")
# nice_plot(res1$correct_samples)
nbg_data <- melt(res1$correct_samples[,1:9])
nbg_data$nbg <- 0
res2 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-2--n_it-30--different--TRUE.rds")
# nice_plot(res2$correct_samples)
nbg_data_temp <- melt(res2$correct_samples[,1:9])
nbg_data_temp$nbg <- 2
nbg_data <- rbind(nbg_data,nbg_data_temp)
res3 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-4--n_it-30--different--TRUE.rds")
nbg_data_temp <- melt(res3$correct_samples[,1:9])
library(extrafont)
## plot netClust versions for different numbers of covariates
res1 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-0--n_it-30--different--TRUE.rds")
# nice_plot(res1$correct_samples)
nbg_data <- melt(res1$correct_samples[,1:9])
nbg_data$nbg <- 0
res2 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-2--n_it-30--different--TRUE.rds")
# nice_plot(res2$correct_samples)
nbg_data_temp <- melt(res2$correct_samples[,1:9])
nbg_data_temp$nbg <- 2
nbg_data <- rbind(nbg_data,nbg_data_temp)
res3 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-4--n_it-30--different--TRUE.rds")
nbg_data_temp <- melt(res3$correct_samples[,1:9])
# nice_plot1 <- nice_plot(res3$correct_samples)
nbg_data_temp$nbg <- 4
nbg_data <- rbind(nbg_data,nbg_data_temp)
res4 <- readRDS("results/results--k_clust-6--n_vars-20--n_bg-6--n_it-30--different--TRUE.rds")
# nice_plot(res4$correct_samples)
nbg_data_temp <- melt(res4$correct_samples[,1:9])
nbg_data_temp$nbg <- 6
nbg_data <- rbind(nbg_data,nbg_data_temp)
colnames(nbg_data)[2] <- "Method"
color_list <- RColorBrewer::brewer.pal(n = 11, name = "RdYlBu")
cols <- color_list[c(2,9,4,10,1,7,5,8,3)]
# publication figure 2
# remove Mclust (since Gaussian mixture model not interesting for binary data)
nbg_data_reduced <- nbg_data[!nbg_data$Method=="Mclust (cov & var)"&!nbg_data$Method=="Mclust (var)",]
# create labels for publication
levels(nbg_data_reduced$Method) <- c("Cov-adjust (cov. & var.)", "BNMM (cov. & var.)",
"BNMM (var.)", "K-means (cov. & var.)", "K-means (var.)",
"MC", "MC2", "BMM (cov. & var.)", "BMM (var.)")
color_list <- RColorBrewer::brewer.pal(n = 11, name = "RdYlBu")
cols <- color_list[c(2,9,4,1,10,5,3)]
plot_nbg <- ggplot2::ggplot(data=nbg_data_reduced, aes(x=factor(nbg), y=value, fill = Method, colour = Method))+
geom_boxplot(outlier.shape = NA, alpha = 0.5) +
# geom_point(pch = 21, position = position_jitterdodge(0.15), cex = 0.4, alpha = 0.3) +
# geom_jitter(pch = 21, cex = 0.8, alpha = 0.3) +
geom_point(position = position_jitterdodge(), alpha = 0.5, pch = 21, cex = 0.9) +
scale_colour_manual(values = cols) + scale_fill_manual(values = cols) +
labs(y = "Adjusted Rand Index (ARI)", x = "Number of Covariates") +
theme_minimal(); plot_nbg
plot_nbg_nolegend <- ggplot2::ggplot(data=nbg_data_reduced, aes(x=factor(nbg), y=value, fill = Method, colour = Method))+
geom_boxplot(outlier.shape = NA, alpha = 0.5) +
# geom_point(pch = 21, position = position_jitterdodge(0.15), cex = 0.4, alpha = 0.3) +
# geom_jitter(pch = 21, cex = 0.8, alpha = 0.3) +
geom_point(position = position_jitterdodge(), alpha = 0.5, pch = 21, cex = 0.9) +
scale_colour_manual(values = cols) + scale_fill_manual(values = cols) +
labs(y = "Adjusted Rand Index (ARI)", x = "Number of Covariates") +
theme_minimal()+
theme(legend.position = "none"); plot_nbg_nolegend
pdf("font_plot.pdf", family="Impact", width = 18, height = 7)
pdf("font_plot.pdf", family="Times", width = 18, height = 7)
plot_nbg
dev.off()
